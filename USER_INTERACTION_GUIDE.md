# PyQt6 图像查看器交互指南

## 🖱️ 鼠标操作（无限画布模式）

### 缩放操作
- **鼠标滚轮向上滚动** = 放大图像 (1.15倍)
- **鼠标滚轮向下滚动** = 缩小图像 (1/1.15倍)
- **缩放范围**: 5% - 2000% (0.05x - 20x)
- **缩放中心**: 鼠标指针当前位置
- **智能缩放**: 缩放时保持鼠标指向的点不变

### 拖动操作
- **按住鼠标左键并拖动** = 平移图像
- **拖动模式**: 内置ScrollHandDrag模式
- **视觉反馈**: 拖动时光标自动变为手型
- **拖动范围**: 无限制，支持无限画布
- **平滑拖动**: 使用QGraphicsView内置优化

### 重置操作
- **双击鼠标左键** = 重置视图到适合窗口大小
- **重置效果**: 图像居中并缩放到完全显示

## ⌨️ 键盘操作

### 文件操作
- **Ctrl + O** = 打开图像文件
- **Ctrl + S** = 保存当前处理后的图像
- **Ctrl + Q** = 退出应用程序

### 视图操作
- **Ctrl + 0** = 重置视图到原始大小
- **Ctrl + +** = 放大图像
- **Ctrl + -** = 缩小图像

## 📋 菜单操作

### 文件菜单
- **打开** = 选择并加载图像文件
- **保存** = 保存当前处理后的图像
- **退出** = 关闭应用程序

### 视图菜单
- **重置视图** = 恢复图像到适合窗口大小
- **原始大小** = 显示图像的100%大小

## 🎛️ 控制面板操作

### 窗宽窗位调节
- **窗宽滑块**: 调节图像对比度范围
- **窗位滑块**: 调节图像亮度中心
- **实时预览**: 滑块调节时图像实时更新
- **响应速度**: 5-10ms 超快响应

### 图像增强算法
- **Gamma校正**: 调节图像整体亮度
- **直方图均衡化**: 增强图像对比度
- **高斯滤波**: 图像平滑处理
- **中值滤波**: 去除椒盐噪声
- **非锐化掩模**: 图像锐化处理
- **形态学操作**: 腐蚀、膨胀、开运算、闭运算

### 处理历史
- **历史列表**: 显示所有处理步骤
- **撤销操作**: 点击历史项目可回到该状态
- **清除历史**: 重置到原始图像

## 🚀 性能特性

### 缩放性能优化
- **图像金字塔缓存**: 大图像缩放流畅无卡顿
- **智能级别选择**: 自动选择最优显示质量
- **延迟更新**: 60FPS 流畅缩放体验
- **内存优化**: 智能缓存管理，节省内存

### 窗宽窗位优化
- **查找表加速**: 5-10ms 超快响应
- **缓存机制**: 常用设置瞬间切换
- **防抖动**: 平滑调节，避免闪烁

### 多线程处理
- **异步处理**: 图像处理不阻塞界面
- **任务队列**: 支持批量处理
- **进度反馈**: 实时显示处理进度
- **错误处理**: 优雅的错误提示

## 💡 使用技巧

### 高效缩放
1. **精确缩放**: 将鼠标指针放在感兴趣的区域再滚动
2. **快速重置**: 双击快速回到适合窗口大小
3. **大图像**: 利用金字塔缓存，大图像缩放同样流畅

### 精确拖动
1. **平滑拖动**: 按住左键慢慢拖动获得最佳体验
2. **快速定位**: 拖动到边缘后松开，再次拖动继续移动
3. **组合操作**: 先缩放到合适大小，再拖动到感兴趣区域

### 窗宽窗位调节
1. **先调窗宽**: 确定对比度范围
2. **再调窗位**: 微调亮度中心
3. **实时观察**: 边调节边观察图像变化
4. **常用预设**: 软组织窗、骨窗、肺窗等

### 图像处理工作流
1. **加载图像**: Ctrl+O 或菜单打开
2. **调节显示**: 窗宽窗位调到最佳
3. **缩放定位**: 缩放到感兴趣区域
4. **应用算法**: 选择合适的增强算法
5. **保存结果**: Ctrl+S 保存处理后图像

## ⚠️ 注意事项

### 性能相关
- **大图像**: 4K以上图像首次加载可能需要几秒钟创建缓存
- **内存使用**: 金字塔缓存会使用额外内存，但有智能管理
- **处理速度**: 复杂算法可能需要几秒钟，请耐心等待

### 操作相关
- **文件格式**: 支持常见图像格式（JPEG、PNG、TIFF、DICOM等）
- **缩放限制**: 最小5%，最大2000%，超出范围会自动限制
- **拖动边界**: 可以拖动到图像完全移出视窗，双击重置

### 错误处理
- **文件损坏**: 会显示错误提示，请检查文件
- **内存不足**: 会自动优化缓存，释放内存
- **处理失败**: 会显示错误信息，不影响原图像

## 🔧 故障排除

### 缩放不工作
- 确保鼠标指针在图像区域内
- 检查是否有图像加载
- 尝试双击重置视图

### 拖动不工作
- 确保按住鼠标左键
- 检查是否在图像区域内拖动
- 尝试重新加载图像

### 处理很慢
- 大图像处理需要时间，请耐心等待
- 查看状态栏的进度指示
- 可以取消当前处理，重新选择参数

### 界面卡顿
- 现代优化后应该不会卡顿
- 如果仍有问题，请重启应用程序
- 检查系统内存是否充足

---

**提示**: 这个图像查看器经过了三个阶段的性能优化，具备了专业级的响应速度和用户体验。尽情享受流畅的图像查看和处理体验！
